<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>LMS and QML approaches â€¢ modsem</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LMS and QML approaches">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modsem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/modsem.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/customizing.html">customizing interaction terms</a></li>
    <li><a class="dropdown-item" href="../articles/estimation_lms.html">estimation alternatives using the LMS approach</a></li>
    <li><a class="dropdown-item" href="../articles/fit_measures_da.html">fit measures for LMS and QML</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order_interactions.html">higher order interactions</a></li>
    <li><a class="dropdown-item" href="../articles/interaction_two_etas.html">interaction effects between endogenous variables</a></li>
    <li><a class="dropdown-item" href="../articles/lavaan.html">using lavaan functions</a></li>
    <li><a class="dropdown-item" href="../articles/lms_qml.html">LMS and QML approaches</a></li>
    <li><a class="dropdown-item" href="../articles/meanstructure_lms_qml.html">non-centered interaction terms (LMS and QML)</a></li>
    <li><a class="dropdown-item" href="../articles/methods.html">methods</a></li>
    <li><a class="dropdown-item" href="../articles/observed_lms_qml.html">observed variables in the LMS- and QML approach</a></li>
    <li><a class="dropdown-item" href="../articles/plot_interactions.html">plotting interaction effects</a></li>
    <li><a class="dropdown-item" href="../articles/quadratic.html">quadratic effects</a></li>
    <li><a class="dropdown-item" href="../articles/relcorr_items.html">reliability-corrected single items</a></li>
    <li><a class="dropdown-item" href="../articles/simple_slopes.html">simple slopes analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>LMS and QML approaches</h1>
            
      

      <div class="d-none name"><code>lms_qml.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modsem.org" class="external-link">modsem</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is modsem (1.0.12). Please report any bugs!</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-latent-moderated-structural-equations-lms-and-the-quasi-maximum-likelihood-qml-approach">The Latent Moderated Structural Equations (LMS) and the Quasi
Maximum Likelihood (QML) Approach<a class="anchor" aria-label="anchor" href="#the-latent-moderated-structural-equations-lms-and-the-quasi-maximum-likelihood-qml-approach"></a>
</h2>
<p>Both the <code>LMS</code> and <code>QML</code> approaches work on
most models, but interaction effects with endogenous variables can be
tricky to estimate (see the <a href="https://modsem.org/articles/interaction_two_etas.html" class="external-link">vignette</a>).
Both approaches, particularly the <code>LMS</code> approach, are
computationally intensive and are partially implemented in C++ (using
<code>Rcpp</code> and <code>RcppArmadillo</code>). Additionally,
starting parameters are estimated using the double-centering approach,
and the means of the observed variables are used to generate good
starting parameters for faster convergence. If you want to monitor the
progress of the estimation process, you can use
<code>verbose = TRUE</code>.</p>
<div class="section level3">
<h3 id="a-simple-example">A Simple Example<a class="anchor" aria-label="anchor" href="#a-simple-example"></a>
</h3>
<p>Here is an example of the <code>LMS</code> approach for a simple
model. By default, the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function calculates fit
measures compared to a null model (i.e., the same model without an
interaction term).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modsem.org" class="external-link">modsem</a></span><span class="op">)</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st"># Outer Model</span></span>
<span><span class="st">  X =~ x1 + x2 + x3</span></span>
<span><span class="st">  Z =~ z1 + z2 + z3</span></span>
<span><span class="st">  Y =~ y1 + y2 + y3</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Inner Model</span></span>
<span><span class="st">  Y ~ X + Z + X:Z</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">lms1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modsem.html">modsem</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">oneInt</span>, method <span class="op">=</span> <span class="st">"lms"</span><span class="op">)</span></span>
<span><span class="co"># Standardized estimates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lms1</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; modsem (version 1.0.12):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         LMS</span></span>
<span><span class="co">#&gt;   Optimization method                        EMA-NLMINB</span></span>
<span><span class="co">#&gt;   Number of observations                           2000</span></span>
<span><span class="co">#&gt;   Number of iterations                               46</span></span>
<span><span class="co">#&gt;   Loglikelihood                                -17493.6</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 35049.21</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               35222.84</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Numerical Integration:</span></span>
<span><span class="co">#&gt;   Points of integration (per dim)                    24</span></span>
<span><span class="co">#&gt;   Dimensions                                          1</span></span>
<span><span class="co">#&gt;   Total points of integration                        24</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fit Measures for Baseline Model (H0):</span></span>
<span><span class="co">#&gt;   Loglikelihood                               -17831.87</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 35723.75</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               35891.78</span></span>
<span><span class="co">#&gt;   Chi-square                                      17.52</span></span>
<span><span class="co">#&gt;   Degrees of Freedom (Chi-square)                    24</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                            0.826</span></span>
<span><span class="co">#&gt;   RMSEA                                           0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Comparative Fit to H0 (LRT test):</span></span>
<span><span class="co">#&gt;   Loglikelihood change                           338.27</span></span>
<span><span class="co">#&gt;   Difference test (D)                            676.54</span></span>
<span><span class="co">#&gt;   Degrees of freedom (D)                              1</span></span>
<span><span class="co">#&gt;   P-value (D)                                     0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; R-Squared Interaction Model (H1):</span></span>
<span><span class="co">#&gt;   Y                                               0.599</span></span>
<span><span class="co">#&gt; R-Squared Baseline Model (H0):</span></span>
<span><span class="co">#&gt;   Y                                               0.395</span></span>
<span><span class="co">#&gt; R-Squared Change (H1 - H0):</span></span>
<span><span class="co">#&gt;   Y                                               0.204</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt;   Coefficients                             standardized</span></span>
<span><span class="co">#&gt;   Information                                  observed</span></span>
<span><span class="co">#&gt;   Standard errors                              standard</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;   X =~          </span></span>
<span><span class="co">#&gt;     x1              1.000                                 0.928</span></span>
<span><span class="co">#&gt;     x2              0.803      0.013    63.91    0.000    0.892</span></span>
<span><span class="co">#&gt;     x3              0.914      0.013    67.73    0.000    0.913</span></span>
<span><span class="co">#&gt;   Z =~          </span></span>
<span><span class="co">#&gt;     z1              1.000                                 0.927</span></span>
<span><span class="co">#&gt;     z2              0.810      0.012    65.09    0.000    0.898</span></span>
<span><span class="co">#&gt;     z3              0.881      0.013    67.62    0.000    0.913</span></span>
<span><span class="co">#&gt;   Y =~          </span></span>
<span><span class="co">#&gt;     y1              1.000                                 0.969</span></span>
<span><span class="co">#&gt;     y2              0.798      0.007   107.55    0.000    0.954</span></span>
<span><span class="co">#&gt;     y3              0.899      0.008   112.58    0.000    0.961</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;   Y ~           </span></span>
<span><span class="co">#&gt;     X               0.672      0.031    21.66    0.000    0.426</span></span>
<span><span class="co">#&gt;     Z               0.570      0.030    18.75    0.000    0.368</span></span>
<span><span class="co">#&gt;     X:Z             0.718      0.028    25.84    0.000    0.459</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;    .x1              1.024      0.024    42.85    0.000         </span></span>
<span><span class="co">#&gt;    .x2              1.217      0.020    60.92    0.000         </span></span>
<span><span class="co">#&gt;    .x3              0.921      0.022    41.45    0.000         </span></span>
<span><span class="co">#&gt;    .z1              1.011      0.024    41.54    0.000         </span></span>
<span><span class="co">#&gt;    .z2              1.205      0.020    59.24    0.000         </span></span>
<span><span class="co">#&gt;    .z3              0.915      0.022    42.03    0.000         </span></span>
<span><span class="co">#&gt;    .y1              1.037      0.033    31.40    0.000         </span></span>
<span><span class="co">#&gt;    .y2              1.220      0.027    45.42    0.000         </span></span>
<span><span class="co">#&gt;    .y3              0.954      0.030    31.80    0.000         </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;   X ~~          </span></span>
<span><span class="co">#&gt;     Z               0.200      0.024     8.24    0.000    0.200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;    .x1              0.158      0.009    18.17    0.000    0.139</span></span>
<span><span class="co">#&gt;    .x2              0.162      0.007    23.16    0.000    0.204</span></span>
<span><span class="co">#&gt;    .x3              0.164      0.008    20.76    0.000    0.167</span></span>
<span><span class="co">#&gt;    .z1              0.167      0.009    18.50    0.000    0.141</span></span>
<span><span class="co">#&gt;    .z2              0.160      0.007    22.68    0.000    0.193</span></span>
<span><span class="co">#&gt;    .z3              0.158      0.008    20.78    0.000    0.167</span></span>
<span><span class="co">#&gt;    .y1              0.160      0.009    18.01    0.000    0.061</span></span>
<span><span class="co">#&gt;    .y2              0.154      0.007    22.69    0.000    0.090</span></span>
<span><span class="co">#&gt;    .y3              0.164      0.008    20.68    0.000    0.076</span></span>
<span><span class="co">#&gt;     X               0.981      0.036    27.04    0.000    1.000</span></span>
<span><span class="co">#&gt;     Z               1.018      0.038    26.93    0.000    1.000</span></span>
<span><span class="co">#&gt;    .Y               0.980      0.038    25.94    0.000    0.401</span></span></code></pre></div>
<p>Here is the same example using the <code>QML</code> approach:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qml1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modsem.html">modsem</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">oneInt</span>, method <span class="op">=</span> <span class="st">"qml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">qml1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; modsem (version 1.0.12):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         QML</span></span>
<span><span class="co">#&gt;   Optimization method                            NLMINB</span></span>
<span><span class="co">#&gt;   Number of observations                           2000</span></span>
<span><span class="co">#&gt;   Number of iterations                               95</span></span>
<span><span class="co">#&gt;   Loglikelihood                               -17496.22</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 35054.43</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               35228.06</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fit Measures for Baseline Model (H0):</span></span>
<span><span class="co">#&gt;   Loglikelihood                               -17831.87</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 35723.75</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               35891.78</span></span>
<span><span class="co">#&gt;   Chi-square                                      17.52</span></span>
<span><span class="co">#&gt;   Degrees of Freedom (Chi-square)                    24</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                            0.826</span></span>
<span><span class="co">#&gt;   RMSEA                                           0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Comparative Fit to H0 (LRT test):</span></span>
<span><span class="co">#&gt;   Loglikelihood change                           335.66</span></span>
<span><span class="co">#&gt;   Difference test (D)                            671.32</span></span>
<span><span class="co">#&gt;   Degrees of freedom (D)                              1</span></span>
<span><span class="co">#&gt;   P-value (D)                                     0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; R-Squared Interaction Model (H1):</span></span>
<span><span class="co">#&gt;   Y                                               0.607</span></span>
<span><span class="co">#&gt; R-Squared Baseline Model (H0):</span></span>
<span><span class="co">#&gt;   Y                                               0.395</span></span>
<span><span class="co">#&gt; R-Squared Change (H1 - H0):</span></span>
<span><span class="co">#&gt;   Y                                               0.211</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt;   Coefficients                           unstandardized</span></span>
<span><span class="co">#&gt;   Information                                  observed</span></span>
<span><span class="co">#&gt;   Standard errors                              standard</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   X =~          </span></span>
<span><span class="co">#&gt;     x1              1.000                             </span></span>
<span><span class="co">#&gt;     x2              0.803      0.013    63.96    0.000</span></span>
<span><span class="co">#&gt;     x3              0.914      0.013    67.80    0.000</span></span>
<span><span class="co">#&gt;   Z =~          </span></span>
<span><span class="co">#&gt;     z1              1.000                             </span></span>
<span><span class="co">#&gt;     z2              0.810      0.012    65.12    0.000</span></span>
<span><span class="co">#&gt;     z3              0.881      0.013    67.62    0.000</span></span>
<span><span class="co">#&gt;   Y =~          </span></span>
<span><span class="co">#&gt;     y1              1.000                             </span></span>
<span><span class="co">#&gt;     y2              0.798      0.007   107.58    0.000</span></span>
<span><span class="co">#&gt;     y3              0.899      0.008   112.55    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   Y ~           </span></span>
<span><span class="co">#&gt;     X               0.674      0.032    20.94    0.000</span></span>
<span><span class="co">#&gt;     Z               0.566      0.030    18.96    0.000</span></span>
<span><span class="co">#&gt;     X:Z             0.712      0.028    25.46    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .x1              1.023      0.024    42.89    0.000</span></span>
<span><span class="co">#&gt;    .x2              1.215      0.020    60.99    0.000</span></span>
<span><span class="co">#&gt;    .x3              0.919      0.022    41.48    0.000</span></span>
<span><span class="co">#&gt;    .z1              1.012      0.024    41.57    0.000</span></span>
<span><span class="co">#&gt;    .z2              1.206      0.020    59.27    0.000</span></span>
<span><span class="co">#&gt;    .z3              0.916      0.022    42.06    0.000</span></span>
<span><span class="co">#&gt;    .y1              1.038      0.033    31.45    0.000</span></span>
<span><span class="co">#&gt;    .y2              1.221      0.027    45.48    0.000</span></span>
<span><span class="co">#&gt;    .y3              0.954      0.030    31.86    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   X ~~          </span></span>
<span><span class="co">#&gt;     Z               0.200      0.024     8.24    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .x1              0.158      0.009    18.14    0.000</span></span>
<span><span class="co">#&gt;    .x2              0.162      0.007    23.19    0.000</span></span>
<span><span class="co">#&gt;    .x3              0.165      0.008    20.82    0.000</span></span>
<span><span class="co">#&gt;    .z1              0.166      0.009    18.34    0.000</span></span>
<span><span class="co">#&gt;    .z2              0.159      0.007    22.62    0.000</span></span>
<span><span class="co">#&gt;    .z3              0.158      0.008    20.71    0.000</span></span>
<span><span class="co">#&gt;    .y1              0.159      0.009    17.98    0.000</span></span>
<span><span class="co">#&gt;    .y2              0.154      0.007    22.67    0.000</span></span>
<span><span class="co">#&gt;    .y3              0.164      0.008    20.71    0.000</span></span>
<span><span class="co">#&gt;     X               0.983      0.036    26.99    0.000</span></span>
<span><span class="co">#&gt;     Z               1.019      0.038    26.95    0.000</span></span>
<span><span class="co">#&gt;    .Y               0.943      0.038    24.87    0.000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a-more-complicated-example">A More Complicated Example<a class="anchor" aria-label="anchor" href="#a-more-complicated-example"></a>
</h3>
<p>Below is an example of a more complex model based on the theory of
planned behavior (TPB), which includes two endogenous variables and an
interaction between an endogenous and exogenous variable. When
estimating more complex models with the <code>LMS</code> approach, it is
recommended to increase the number of nodes used for numerical
integration. By default, the number of nodes is set to 24, but this can
be increased using the <code>nodes</code> argument. The
<code>nodes</code> argument has no effect on the <code>QML</code>
approach.</p>
<p>When there is an interaction effect between an endogenous and
exogenous variable, it is recommended to use at least 32 nodes for the
<code>LMS</code> approach. You can also obtain robust standard errors by
setting <code>robust.se = TRUE</code> in the <code><a href="../reference/modsem.html">modsem()</a></code>
function.</p>
<p><strong>NOTE</strong>: If you want the <code>LMS</code> approach to
produce results as similar as possible to <code>Mplus</code>, you should
consider increasing the number of nodes using the <code>nodes</code>
argument, and or using a quasi-adaptive quadrature by setting
<code>adaptive.quad=TRUE</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ATT = Attitude</span></span>
<span><span class="co"># PBC = Perceived Behavioral Control</span></span>
<span><span class="co"># INT = Intention</span></span>
<span><span class="co"># SN = Subjective Norms</span></span>
<span><span class="co"># BEH = Behavior</span></span>
<span><span class="va">tpb</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st"># Outer Model (Based on Hagger et al., 2007)</span></span>
<span><span class="st">  ATT =~ att1 + att2 + att3 + att4 + att5</span></span>
<span><span class="st">  SN =~ sn1 + sn2</span></span>
<span><span class="st">  PBC =~ pbc1 + pbc2 + pbc3</span></span>
<span><span class="st">  INT =~ int1 + int2 + int3</span></span>
<span><span class="st">  BEH =~ b1 + b2</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Inner Model (Based on Steinmetz et al., 2011)</span></span>
<span><span class="st">  INT ~ ATT + SN + PBC</span></span>
<span><span class="st">  BEH ~ INT + PBC</span></span>
<span><span class="st">  BEH ~ INT:PBC</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">lms2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modsem.html">modsem</a></span><span class="op">(</span><span class="va">tpb</span>, <span class="va">TPB</span>, method <span class="op">=</span> <span class="st">"lms"</span>, nodes <span class="op">=</span> <span class="fl">32</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lms2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; modsem (version 1.0.12):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         LMS</span></span>
<span><span class="co">#&gt;   Optimization method                        EMA-NLMINB</span></span>
<span><span class="co">#&gt;   Number of observations                           2000</span></span>
<span><span class="co">#&gt;   Number of iterations                               32</span></span>
<span><span class="co">#&gt;   Loglikelihood                               -26326.02</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 52760.04</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               53062.49</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Numerical Integration:</span></span>
<span><span class="co">#&gt;   Points of integration (per dim)                    32</span></span>
<span><span class="co">#&gt;   Dimensions                                          1</span></span>
<span><span class="co">#&gt;   Total points of integration                        32</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fit Measures for Baseline Model (H0):</span></span>
<span><span class="co">#&gt;   Loglikelihood                               -26393.22</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 52892.45</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               53189.29</span></span>
<span><span class="co">#&gt;   Chi-square                                      66.27</span></span>
<span><span class="co">#&gt;   Degrees of Freedom (Chi-square)                    82</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                            0.897</span></span>
<span><span class="co">#&gt;   RMSEA                                           0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Comparative Fit to H0 (LRT test):</span></span>
<span><span class="co">#&gt;   Loglikelihood change                            67.20</span></span>
<span><span class="co">#&gt;   Difference test (D)                            134.40</span></span>
<span><span class="co">#&gt;   Degrees of freedom (D)                              1</span></span>
<span><span class="co">#&gt;   P-value (D)                                     0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; R-Squared Interaction Model (H1):</span></span>
<span><span class="co">#&gt;   INT                                             0.366</span></span>
<span><span class="co">#&gt;   BEH                                             0.263</span></span>
<span><span class="co">#&gt; R-Squared Baseline Model (H0):</span></span>
<span><span class="co">#&gt;   INT                                             0.367</span></span>
<span><span class="co">#&gt;   BEH                                             0.210</span></span>
<span><span class="co">#&gt; R-Squared Change (H1 - H0):</span></span>
<span><span class="co">#&gt;   INT                                            -0.001</span></span>
<span><span class="co">#&gt;   BEH                                             0.053</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt;   Coefficients                           unstandardized</span></span>
<span><span class="co">#&gt;   Information                                  observed</span></span>
<span><span class="co">#&gt;   Standard errors                              standard</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   PBC =~        </span></span>
<span><span class="co">#&gt;     pbc1            1.000                             </span></span>
<span><span class="co">#&gt;     pbc2            0.912      0.013    69.46    0.000</span></span>
<span><span class="co">#&gt;     pbc3            0.801      0.012    66.09    0.000</span></span>
<span><span class="co">#&gt;   ATT =~        </span></span>
<span><span class="co">#&gt;     att1            1.000                             </span></span>
<span><span class="co">#&gt;     att2            0.878      0.012    71.56    0.000</span></span>
<span><span class="co">#&gt;     att3            0.789      0.012    66.38    0.000</span></span>
<span><span class="co">#&gt;     att4            0.695      0.011    61.00    0.000</span></span>
<span><span class="co">#&gt;     att5            0.887      0.013    70.85    0.000</span></span>
<span><span class="co">#&gt;   SN =~         </span></span>
<span><span class="co">#&gt;     sn1             1.000                             </span></span>
<span><span class="co">#&gt;     sn2             0.888      0.017    52.60    0.000</span></span>
<span><span class="co">#&gt;   INT =~        </span></span>
<span><span class="co">#&gt;     int1            1.000                             </span></span>
<span><span class="co">#&gt;     int2            0.913      0.015    59.06    0.000</span></span>
<span><span class="co">#&gt;     int3            0.807      0.014    55.74    0.000</span></span>
<span><span class="co">#&gt;   BEH =~        </span></span>
<span><span class="co">#&gt;     b1              1.000                             </span></span>
<span><span class="co">#&gt;     b2              0.960      0.030    31.75    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   INT ~         </span></span>
<span><span class="co">#&gt;     PBC             0.217      0.030     7.35    0.000</span></span>
<span><span class="co">#&gt;     ATT             0.213      0.026     8.16    0.000</span></span>
<span><span class="co">#&gt;     SN              0.176      0.028     6.38    0.000</span></span>
<span><span class="co">#&gt;   BEH ~         </span></span>
<span><span class="co">#&gt;     PBC             0.232      0.022    10.41    0.000</span></span>
<span><span class="co">#&gt;     INT             0.190      0.025     7.68    0.000</span></span>
<span><span class="co">#&gt;     PBC:INT         0.205      0.018    11.31    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .pbc1            0.998      0.024    42.46    0.000</span></span>
<span><span class="co">#&gt;    .pbc2            0.985      0.022    44.98    0.000</span></span>
<span><span class="co">#&gt;    .pbc3            0.992      0.020    50.50    0.000</span></span>
<span><span class="co">#&gt;    .att1            1.014      0.024    42.00    0.000</span></span>
<span><span class="co">#&gt;    .att2            1.007      0.021    46.97    0.000</span></span>
<span><span class="co">#&gt;    .att3            1.016      0.020    51.46    0.000</span></span>
<span><span class="co">#&gt;    .att4            0.999      0.018    55.66    0.000</span></span>
<span><span class="co">#&gt;    .att5            0.992      0.022    45.67    0.000</span></span>
<span><span class="co">#&gt;    .sn1             1.006      0.024    41.68    0.000</span></span>
<span><span class="co">#&gt;    .sn2             1.010      0.022    46.73    0.000</span></span>
<span><span class="co">#&gt;    .int1            1.014      0.022    46.97    0.000</span></span>
<span><span class="co">#&gt;    .int2            1.012      0.020    50.41    0.000</span></span>
<span><span class="co">#&gt;    .int3            1.005      0.018    54.81    0.000</span></span>
<span><span class="co">#&gt;    .b1              1.001      0.021    46.99    0.000</span></span>
<span><span class="co">#&gt;    .b2              1.019      0.020    51.07    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   PBC ~~        </span></span>
<span><span class="co">#&gt;     ATT             0.678      0.029    23.74    0.000</span></span>
<span><span class="co">#&gt;     SN              0.677      0.029    23.36    0.000</span></span>
<span><span class="co">#&gt;   ATT ~~        </span></span>
<span><span class="co">#&gt;     SN              0.629      0.029    21.95    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .pbc1            0.144      0.008    18.39    0.000</span></span>
<span><span class="co">#&gt;    .pbc2            0.160      0.007    21.44    0.000</span></span>
<span><span class="co">#&gt;    .pbc3            0.155      0.006    23.90    0.000</span></span>
<span><span class="co">#&gt;    .att1            0.167      0.007    23.54    0.000</span></span>
<span><span class="co">#&gt;    .att2            0.150      0.006    24.72    0.000</span></span>
<span><span class="co">#&gt;    .att3            0.159      0.006    26.39    0.000</span></span>
<span><span class="co">#&gt;    .att4            0.162      0.006    27.66    0.000</span></span>
<span><span class="co">#&gt;    .att5            0.159      0.006    24.93    0.000</span></span>
<span><span class="co">#&gt;    .sn1             0.178      0.015    12.09    0.000</span></span>
<span><span class="co">#&gt;    .sn2             0.157      0.012    13.26    0.000</span></span>
<span><span class="co">#&gt;    .int1            0.157      0.009    18.11    0.000</span></span>
<span><span class="co">#&gt;    .int2            0.160      0.008    20.41    0.000</span></span>
<span><span class="co">#&gt;    .int3            0.168      0.007    23.55    0.000</span></span>
<span><span class="co">#&gt;    .b1              0.186      0.018    10.12    0.000</span></span>
<span><span class="co">#&gt;    .b2              0.135      0.017     8.14    0.000</span></span>
<span><span class="co">#&gt;     PBC             0.962      0.035    27.31    0.000</span></span>
<span><span class="co">#&gt;     ATT             0.998      0.037    27.14    0.000</span></span>
<span><span class="co">#&gt;     SN              0.987      0.039    25.41    0.000</span></span>
<span><span class="co">#&gt;    .INT             0.491      0.020    24.65    0.000</span></span>
<span><span class="co">#&gt;    .BEH             0.455      0.023    20.14    0.000</span></span>
<span></span>
<span><span class="va">qml2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modsem.html">modsem</a></span><span class="op">(</span><span class="va">tpb</span>, <span class="va">TPB</span>, method <span class="op">=</span> <span class="st">"qml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">qml2</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Standardized estimates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; modsem (version 1.0.12):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         QML</span></span>
<span><span class="co">#&gt;   Optimization method                            NLMINB</span></span>
<span><span class="co">#&gt;   Number of observations                           2000</span></span>
<span><span class="co">#&gt;   Number of iterations                               65</span></span>
<span><span class="co">#&gt;   Loglikelihood                               -26326.23</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 52760.46</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               53062.91</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fit Measures for Baseline Model (H0):</span></span>
<span><span class="co">#&gt;   Loglikelihood                               -26393.22</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 52892.45</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               53189.29</span></span>
<span><span class="co">#&gt;   Chi-square                                      66.27</span></span>
<span><span class="co">#&gt;   Degrees of Freedom (Chi-square)                    82</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                            0.897</span></span>
<span><span class="co">#&gt;   RMSEA                                           0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Comparative Fit to H0 (LRT test):</span></span>
<span><span class="co">#&gt;   Loglikelihood change                            66.99</span></span>
<span><span class="co">#&gt;   Difference test (D)                            133.98</span></span>
<span><span class="co">#&gt;   Degrees of freedom (D)                              1</span></span>
<span><span class="co">#&gt;   P-value (D)                                     0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; R-Squared Interaction Model (H1):</span></span>
<span><span class="co">#&gt;   BEH                                             0.263</span></span>
<span><span class="co">#&gt;   INT                                             0.366</span></span>
<span><span class="co">#&gt; R-Squared Baseline Model (H0):</span></span>
<span><span class="co">#&gt;   BEH                                             0.210</span></span>
<span><span class="co">#&gt;   INT                                             0.367</span></span>
<span><span class="co">#&gt; R-Squared Change (H1 - H0):</span></span>
<span><span class="co">#&gt;   BEH                                             0.053</span></span>
<span><span class="co">#&gt;   INT                                             0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt;   Coefficients                             standardized</span></span>
<span><span class="co">#&gt;   Information                                  observed</span></span>
<span><span class="co">#&gt;   Standard errors                              standard</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;   INT =~        </span></span>
<span><span class="co">#&gt;     int1            1.000                                 0.912</span></span>
<span><span class="co">#&gt;     int2            0.913      0.015    59.05    0.000    0.895</span></span>
<span><span class="co">#&gt;     int3            0.807      0.014    55.73    0.000    0.867</span></span>
<span><span class="co">#&gt;   ATT =~        </span></span>
<span><span class="co">#&gt;     att1            1.000                                 0.925</span></span>
<span><span class="co">#&gt;     att2            0.878      0.012    71.56    0.000    0.915</span></span>
<span><span class="co">#&gt;     att3            0.789      0.012    66.37    0.000    0.892</span></span>
<span><span class="co">#&gt;     att4            0.695      0.011    61.00    0.000    0.865</span></span>
<span><span class="co">#&gt;     att5            0.887      0.013    70.85    0.000    0.912</span></span>
<span><span class="co">#&gt;   SN =~         </span></span>
<span><span class="co">#&gt;     sn1             1.000                                 0.921</span></span>
<span><span class="co">#&gt;     sn2             0.888      0.017    52.62    0.000    0.913</span></span>
<span><span class="co">#&gt;   PBC =~        </span></span>
<span><span class="co">#&gt;     pbc1            1.000                                 0.933</span></span>
<span><span class="co">#&gt;     pbc2            0.912      0.013    69.47    0.000    0.913</span></span>
<span><span class="co">#&gt;     pbc3            0.801      0.012    66.10    0.000    0.894</span></span>
<span><span class="co">#&gt;   BEH =~        </span></span>
<span><span class="co">#&gt;     b1              1.000                                 0.876</span></span>
<span><span class="co">#&gt;     b2              0.961      0.030    31.75    0.000    0.899</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;   BEH ~         </span></span>
<span><span class="co">#&gt;     INT             0.189      0.025     7.63    0.000    0.212</span></span>
<span><span class="co">#&gt;     PBC             0.233      0.022    10.45    0.000    0.291</span></span>
<span><span class="co">#&gt;     INT:PBC         0.203      0.018    11.26    0.000    0.224</span></span>
<span><span class="co">#&gt;   INT ~         </span></span>
<span><span class="co">#&gt;     ATT             0.213      0.026     8.16    0.000    0.242</span></span>
<span><span class="co">#&gt;     SN              0.176      0.028     6.38    0.000    0.199</span></span>
<span><span class="co">#&gt;     PBC             0.218      0.030     7.35    0.000    0.242</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;    .int1            1.014      0.022    46.96    0.000         </span></span>
<span><span class="co">#&gt;    .int2            1.012      0.020    50.40    0.000         </span></span>
<span><span class="co">#&gt;    .int3            1.005      0.018    54.80    0.000         </span></span>
<span><span class="co">#&gt;    .att1            1.014      0.024    42.00    0.000         </span></span>
<span><span class="co">#&gt;    .att2            1.007      0.021    46.96    0.000         </span></span>
<span><span class="co">#&gt;    .att3            1.016      0.020    51.45    0.000         </span></span>
<span><span class="co">#&gt;    .att4            0.999      0.018    55.65    0.000         </span></span>
<span><span class="co">#&gt;    .att5            0.992      0.022    45.67    0.000         </span></span>
<span><span class="co">#&gt;    .sn1             1.006      0.024    41.66    0.000         </span></span>
<span><span class="co">#&gt;    .sn2             1.010      0.022    46.70    0.000         </span></span>
<span><span class="co">#&gt;    .pbc1            0.998      0.024    42.41    0.000         </span></span>
<span><span class="co">#&gt;    .pbc2            0.985      0.022    44.93    0.000         </span></span>
<span><span class="co">#&gt;    .pbc3            0.991      0.020    50.45    0.000         </span></span>
<span><span class="co">#&gt;    .b1              1.002      0.021    47.12    0.000         </span></span>
<span><span class="co">#&gt;    .b2              1.020      0.020    51.20    0.000         </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;   ATT ~~        </span></span>
<span><span class="co">#&gt;     SN              0.629      0.029    21.70    0.000    0.634</span></span>
<span><span class="co">#&gt;     PBC             0.678      0.029    23.45    0.000    0.692</span></span>
<span><span class="co">#&gt;   SN ~~         </span></span>
<span><span class="co">#&gt;     PBC             0.678      0.029    23.08    0.000    0.695</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                  Estimate  Std.Error  z.value  P(&gt;|z|)  Std.all</span></span>
<span><span class="co">#&gt;    .int1            0.157      0.009    18.11    0.000    0.168</span></span>
<span><span class="co">#&gt;    .int2            0.160      0.008    20.41    0.000    0.199</span></span>
<span><span class="co">#&gt;    .int3            0.168      0.007    23.55    0.000    0.249</span></span>
<span><span class="co">#&gt;    .att1            0.167      0.007    23.53    0.000    0.144</span></span>
<span><span class="co">#&gt;    .att2            0.150      0.006    24.71    0.000    0.164</span></span>
<span><span class="co">#&gt;    .att3            0.160      0.006    26.38    0.000    0.204</span></span>
<span><span class="co">#&gt;    .att4            0.162      0.006    27.65    0.000    0.252</span></span>
<span><span class="co">#&gt;    .att5            0.159      0.006    24.93    0.000    0.168</span></span>
<span><span class="co">#&gt;    .sn1             0.178      0.015    12.09    0.000    0.153</span></span>
<span><span class="co">#&gt;    .sn2             0.157      0.012    13.26    0.000    0.167</span></span>
<span><span class="co">#&gt;    .pbc1            0.144      0.008    18.39    0.000    0.130</span></span>
<span><span class="co">#&gt;    .pbc2            0.160      0.007    21.43    0.000    0.166</span></span>
<span><span class="co">#&gt;    .pbc3            0.155      0.006    23.89    0.000    0.201</span></span>
<span><span class="co">#&gt;    .b1              0.186      0.018    10.14    0.000    0.233</span></span>
<span><span class="co">#&gt;    .b2              0.135      0.017     8.11    0.000    0.192</span></span>
<span><span class="co">#&gt;    .BEH             0.453      0.023    20.07    0.000    0.737</span></span>
<span><span class="co">#&gt;    .INT             0.491      0.020    24.64    0.000    0.634</span></span>
<span><span class="co">#&gt;     ATT             0.998      0.037    26.93    0.000    1.000</span></span>
<span><span class="co">#&gt;     SN              0.988      0.039    25.22    0.000    1.000</span></span>
<span><span class="co">#&gt;     PBC             0.963      0.036    27.07    0.000    1.000</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kjell Solem Slupphaug.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
