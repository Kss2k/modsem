<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>estimation alternatives using the LMS approach â€¢ modsem</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="estimation alternatives using the LMS approach">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modsem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/modsem.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/customizing.html">customizing interaction terms</a></li>
    <li><a class="dropdown-item" href="../articles/estimation_lms.html">estimation alternatives using the LMS approach</a></li>
    <li><a class="dropdown-item" href="../articles/fit_measures_da.html">fit measures for LMS and QML</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order_interactions.html">higher order interactions</a></li>
    <li><a class="dropdown-item" href="../articles/interaction_two_etas.html">interaction effects between endogenous variables</a></li>
    <li><a class="dropdown-item" href="../articles/lavaan.html">using lavaan functions</a></li>
    <li><a class="dropdown-item" href="../articles/lms_qml.html">LMS and QML approaches</a></li>
    <li><a class="dropdown-item" href="../articles/methods.html">methods</a></li>
    <li><a class="dropdown-item" href="../articles/observed_lms_qml.html">observed variables in the LMS- and QML approach</a></li>
    <li><a class="dropdown-item" href="../articles/plot_interactions.html">plotting interaction effects</a></li>
    <li><a class="dropdown-item" href="../articles/quadratic.html">quadratic effects</a></li>
    <li><a class="dropdown-item" href="../articles/simple_slopes.html">simple slopes analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>estimation alternatives using the LMS approach</h1>
            
      

      <div class="d-none name"><code>estimation_lms.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modsem.org" class="external-link">modsem</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="accelerated-em-and-adaptive-quadrature">Accelerated EM and Adaptive Quadrature<a class="anchor" aria-label="anchor" href="#accelerated-em-and-adaptive-quadrature"></a>
</h2>
<p>By default (as of <code>v1.0.9</code>) the LMS approach uses an
accelerated EM procedure (<code>"EMA"</code>) that uses Quasi-Newton and
Fisher Scoring optimization steps when needed. If desireable, this can
be switched to the standard Expectation-Maximization (EM) algorithm, by
setting <code>algorithm = "EM"</code>.</p>
<p>By default the LMS approach also uses a fixed Gauss-Hermite
quadrature, to estimate a numerical approximation of the log-likelihood.
Instead of a fixed quadrature, it is possible to use a quasi-adaptive
quadrature instead. Due to performance reasons, the adaptive quadrature
does not fit an individual quadrature to each participant, but instead
one for the entire sample (at each EM iteration), based on the whole
sample densities of the likelihood function. This usually means that
more nodes are placed towards the center of the distribution, compared
to a standard fixed Gauss-Hermite quadrature. Using the EMA and adaptive
quadrature might yield estimates that are closer to results from
<code>Mplus</code>.</p>
<p>If the model struggles to converge, you can try using the accelerated
EM procedure by setting <code>method = "EMA"</code>, and
<code>adaptive.quad = TRUE</code> in the <code><a href="../reference/modsem.html">modsem()</a></code> function.
Additionally it is possible to tweak these parameters:</p>
<ul>
<li>
<code>max.iter</code>: Maximum number of iterations for the EM
algorithm (default is 500).</li>
<li>
<code>max.step</code>: Maximum number of steps used in the
Maximization step of the EM algorithm (default is 1).</li>
<li>
<code>convergence.rel</code>: Relative convergence criterion for the
EM algorithm.</li>
<li>
<code>convergence.abs</code>: Absolute convergence criterion for the
EM algorithm.</li>
<li>
<code>nodes</code>: Number of nodes for numerical integration
(default is 24). Increasing this number can improve the accuracy of the
estimates, especially for complex models.</li>
<li>
<code>quad.range</code>: Integration range for quadrature. Smaller
ranges means that the integral is more focused. Applies to only when
using a quasi-adaptive quadrature.</li>
<li>
<code>adaptive.frequency</code>: How often should the quasi-adaptive
quadrature be calculated? Defaults to every third EM iteration.</li>
</ul>
<p>Here we can see an example using the <code>TPB_UK</code> dataaset,
which is more troublesome to estimate than the simulated
<code>TPB</code> dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tpb_uk</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st"># Outer Model (Based on Hagger et al., 2007)</span></span>
<span><span class="st">  ATT =~ att3 + att2 + att1 + att4</span></span>
<span><span class="st">  SN =~ sn4 + sn2 + sn3 + sn1</span></span>
<span><span class="st">  PBC =~ pbc2 + pbc1 + pbc3 + pbc4</span></span>
<span><span class="st">  INT =~ int2 + int1 + int3 + int4</span></span>
<span><span class="st">  BEH =~ beh3 + beh2 + beh1 + beh4</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Inner Model (Based on Steinmetz et al., 2011)</span></span>
<span><span class="st">  INT ~ ATT + SN + PBC</span></span>
<span><span class="st">  BEH ~ INT + PBC</span></span>
<span><span class="st">  BEH ~ INT:PBC</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modsem.html">modsem</a></span><span class="op">(</span><span class="va">tpb_uk</span>, </span>
<span>              data <span class="op">=</span> <span class="va">TPB_UK</span>, </span>
<span>              method <span class="op">=</span> <span class="st">"lms"</span>, </span>
<span>              nodes <span class="op">=</span> <span class="fl">32</span>, <span class="co"># Number of nodes for numerical integration</span></span>
<span>              adaptive.quad <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Use quasi-adaptive quadrature</span></span>
<span>              adaptive.frequency <span class="op">=</span> <span class="fl">3</span>, <span class="co"># Update the quasi-adaptive quadrature every third EM-iteration</span></span>
<span>              algorithm <span class="op">=</span><span class="st">"EMA"</span>, <span class="co"># Use accelerated EM algorithm (Default)</span></span>
<span>              convergence.abs <span class="op">=</span> <span class="fl">1e-4</span>, <span class="co"># Relative convergence criterion</span></span>
<span>              convergence.rel <span class="op">=</span> <span class="fl">1e-10</span>, <span class="co"># Relative convergence criterion</span></span>
<span>              max.iter <span class="op">=</span> <span class="fl">500</span>, <span class="co"># Maximum number of iterations</span></span>
<span>              max.step <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Maximum number of steps in the maximization step</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimating baseline model (H0)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; modsem (version 1.0.9):</span></span>
<span><span class="co">#&gt;   Estimator                                         LMS</span></span>
<span><span class="co">#&gt;   Optimization method                        EMA-NLMINB</span></span>
<span><span class="co">#&gt;   Number of observations                           1169</span></span>
<span><span class="co">#&gt;   Number of iterations                              110</span></span>
<span><span class="co">#&gt;   Loglikelihood                               -33404.43</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 66946.87</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               67296.28</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Numerical Integration:</span></span>
<span><span class="co">#&gt;   Points of integration (per dim)                    32</span></span>
<span><span class="co">#&gt;   Dimensions                                          1</span></span>
<span><span class="co">#&gt;   Total points of integration                        32</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fit Measures for H0:</span></span>
<span><span class="co">#&gt;   Loglikelihood                                  -35523</span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 71181.74</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               71526.09</span></span>
<span><span class="co">#&gt;   Chi-square                                    5519.01</span></span>
<span><span class="co">#&gt;   Degrees of Freedom (Chi-square)                   162</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                            0.000</span></span>
<span><span class="co">#&gt;   RMSEA                                           0.168</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Comparative fit to H0 (no interaction effect)</span></span>
<span><span class="co">#&gt;   Loglikelihood change                          2118.44</span></span>
<span><span class="co">#&gt;   Difference test (D)                           4236.87</span></span>
<span><span class="co">#&gt;   Degrees of freedom (D)                              1</span></span>
<span><span class="co">#&gt;   P-value (D)                                     0.000</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; R-Squared:</span></span>
<span><span class="co">#&gt;   INT                                             0.898</span></span>
<span><span class="co">#&gt;   BEH                                             0.922</span></span>
<span><span class="co">#&gt; R-Squared Null-Model (H0):</span></span>
<span><span class="co">#&gt;   INT                                             0.896</span></span>
<span><span class="co">#&gt;   BEH                                             0.867</span></span>
<span><span class="co">#&gt; R-Squared Change:</span></span>
<span><span class="co">#&gt;   INT                                             0.002</span></span>
<span><span class="co">#&gt;   BEH                                             0.055</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt;   Coefficients                           unstandardized</span></span>
<span><span class="co">#&gt;   Information                                  observed</span></span>
<span><span class="co">#&gt;   Standard errors                              standard</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                   Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   PBC =~ </span></span>
<span><span class="co">#&gt;     pbc2             1.000                             </span></span>
<span><span class="co">#&gt;     pbc1             0.859      0.021    41.34    0.000</span></span>
<span><span class="co">#&gt;     pbc3             0.935      0.017    55.09    0.000</span></span>
<span><span class="co">#&gt;     pbc4             0.818      0.021    39.86    0.000</span></span>
<span><span class="co">#&gt;   ATT =~ </span></span>
<span><span class="co">#&gt;     att3             1.000                             </span></span>
<span><span class="co">#&gt;     att2             0.965      0.011    86.35    0.000</span></span>
<span><span class="co">#&gt;     att1             0.812      0.017    47.19    0.000</span></span>
<span><span class="co">#&gt;     att4             0.870      0.019    45.46    0.000</span></span>
<span><span class="co">#&gt;   SN =~ </span></span>
<span><span class="co">#&gt;     sn4              1.000                             </span></span>
<span><span class="co">#&gt;     sn2              1.313      0.041    32.30    0.000</span></span>
<span><span class="co">#&gt;     sn3              1.350      0.041    32.72    0.000</span></span>
<span><span class="co">#&gt;     sn1              1.000      0.038    26.60    0.000</span></span>
<span><span class="co">#&gt;   INT =~ </span></span>
<span><span class="co">#&gt;     int2             1.000                             </span></span>
<span><span class="co">#&gt;     int1             0.970      0.011    92.12    0.000</span></span>
<span><span class="co">#&gt;     int3             0.984      0.010    98.42    0.000</span></span>
<span><span class="co">#&gt;     int4             0.992      0.009   104.58    0.000</span></span>
<span><span class="co">#&gt;   BEH =~ </span></span>
<span><span class="co">#&gt;     beh3             1.000                             </span></span>
<span><span class="co">#&gt;     beh2             0.986      0.013    77.72    0.000</span></span>
<span><span class="co">#&gt;     beh1             0.814      0.019    42.72    0.000</span></span>
<span><span class="co">#&gt;     beh4             0.803      0.019    41.50    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                   Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   INT ~ </span></span>
<span><span class="co">#&gt;     PBC              1.036      0.036    28.45    0.000</span></span>
<span><span class="co">#&gt;     ATT             -0.060      0.030    -2.04    0.042</span></span>
<span><span class="co">#&gt;     SN               0.051      0.033     1.55    0.120</span></span>
<span><span class="co">#&gt;   BEH ~ </span></span>
<span><span class="co">#&gt;     PBC              0.397      0.052     7.62    0.000</span></span>
<span><span class="co">#&gt;     INT              0.596      0.048    12.28    0.000</span></span>
<span><span class="co">#&gt;     PBC:INT          0.140      0.008    17.64    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                   Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;     pbc2             4.027      0.066    61.17    0.000</span></span>
<span><span class="co">#&gt;     pbc1             3.994      0.063    63.15    0.000</span></span>
<span><span class="co">#&gt;     pbc3             3.763      0.063    59.89    0.000</span></span>
<span><span class="co">#&gt;     pbc4             3.797      0.061    62.03    0.000</span></span>
<span><span class="co">#&gt;     att3             3.730      0.064    58.50    0.000</span></span>
<span><span class="co">#&gt;     att2             3.845      0.062    62.28    0.000</span></span>
<span><span class="co">#&gt;     att1             4.216      0.060    70.13    0.000</span></span>
<span><span class="co">#&gt;     att4             3.696      0.065    56.76    0.000</span></span>
<span><span class="co">#&gt;     sn4              4.504      0.051    87.74    0.000</span></span>
<span><span class="co">#&gt;     sn2              4.353      0.054    80.08    0.000</span></span>
<span><span class="co">#&gt;     sn3              4.393      0.055    80.19    0.000</span></span>
<span><span class="co">#&gt;     sn1              4.473      0.052    85.98    0.000</span></span>
<span><span class="co">#&gt;     int2             3.731      0.067    55.99    0.000</span></span>
<span><span class="co">#&gt;     int1             3.876      0.066    58.89    0.000</span></span>
<span><span class="co">#&gt;     int3             3.748      0.066    56.57    0.000</span></span>
<span><span class="co">#&gt;     int4             3.791      0.066    57.14    0.000</span></span>
<span><span class="co">#&gt;     beh3             2.666      0.076    34.98    0.000</span></span>
<span><span class="co">#&gt;     beh2             2.585      0.076    34.17    0.000</span></span>
<span><span class="co">#&gt;     beh1             2.546      0.073    35.07    0.000</span></span>
<span><span class="co">#&gt;     beh4             2.688      0.072    37.12    0.000</span></span>
<span><span class="co">#&gt;     INT              0.000                             </span></span>
<span><span class="co">#&gt;     BEH              0.000                             </span></span>
<span><span class="co">#&gt;     PBC              0.000                             </span></span>
<span><span class="co">#&gt;     ATT              0.000                             </span></span>
<span><span class="co">#&gt;     SN               0.000                             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                   Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   PBC ~~ </span></span>
<span><span class="co">#&gt;     ATT              3.679      0.177    20.80    0.000</span></span>
<span><span class="co">#&gt;     SN               1.937      0.117    16.60    0.000</span></span>
<span><span class="co">#&gt;   ATT ~~ </span></span>
<span><span class="co">#&gt;     SN               1.681      0.110    15.30    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                   Estimate  Std.Error  z.value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;     pbc2             0.701      0.042    16.68    0.000</span></span>
<span><span class="co">#&gt;     pbc1             1.455      0.069    21.00    0.000</span></span>
<span><span class="co">#&gt;     pbc3             0.802      0.043    18.62    0.000</span></span>
<span><span class="co">#&gt;     pbc4             1.458      0.068    21.28    0.000</span></span>
<span><span class="co">#&gt;     att3             0.296      0.023    12.81    0.000</span></span>
<span><span class="co">#&gt;     att2             0.306      0.022    13.81    0.000</span></span>
<span><span class="co">#&gt;     att1             1.285      0.057    22.58    0.000</span></span>
<span><span class="co">#&gt;     att4             1.584      0.071    22.42    0.000</span></span>
<span><span class="co">#&gt;     sn4              1.362      0.065    21.03    0.000</span></span>
<span><span class="co">#&gt;     sn2              0.491      0.032    15.39    0.000</span></span>
<span><span class="co">#&gt;     sn3              0.377      0.032    11.89    0.000</span></span>
<span><span class="co">#&gt;     sn1              1.445      0.068    21.13    0.000</span></span>
<span><span class="co">#&gt;     int2             0.237      0.014    16.97    0.000</span></span>
<span><span class="co">#&gt;     int1             0.404      0.020    20.25    0.000</span></span>
<span><span class="co">#&gt;     int3             0.335      0.017    19.35    0.000</span></span>
<span><span class="co">#&gt;     int4             0.271      0.015    17.90    0.000</span></span>
<span><span class="co">#&gt;     beh3             0.456      0.030    15.26    0.000</span></span>
<span><span class="co">#&gt;     beh2             0.513      0.031    16.55    0.000</span></span>
<span><span class="co">#&gt;     beh1             1.835      0.082    22.32    0.000</span></span>
<span><span class="co">#&gt;     beh4             1.915      0.085    22.42    0.000</span></span>
<span><span class="co">#&gt;     PBC              4.362      0.209    20.83    0.000</span></span>
<span><span class="co">#&gt;     ATT              4.454      0.197    22.60    0.000</span></span>
<span><span class="co">#&gt;     SN               1.717      0.119    14.49    0.000</span></span>
<span><span class="co">#&gt;     INT              0.507      0.038    13.28    0.000</span></span>
<span><span class="co">#&gt;     BEH              0.449      0.034    13.25    0.000</span></span></code></pre></div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kjell Solem Slupphaug.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
